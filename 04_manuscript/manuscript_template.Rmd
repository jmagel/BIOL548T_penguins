---
title: How does tree harvest influence benthic invertebrate density?
geometry: margin=1in

# these header-includes are packages for generating latex files (tex) they will 
# be installed if needed the first time they are called.
header-includes:
    - \usepackage{setspace}
    - \doublespacing
    - \usepackage{lineno}
    - \linenumbers
    - \usepackage{float}            # this controls the placement of images in PDF files (allows fig.pos = 'H')
    - \usepackage{fontspec}         # can only be used with xelatex output
    - \setmainfont{Times New Roman} # can only be used with xelatex output

# This section tells the rendering engine what we want as output. You can specify
# one format or many. The output below specifies three formats (PDF, HTML, Word)
# BUT by default only the first will be generated when you knit the document. To
# get around that (if you want all three for example) you can create a custom 
# function (or hook) that gets run when you press the knit button. 
# See "knit:..." below this.
output:
  pdf_document: 
    latex_engine: xelatex
    keep_tex: false
  html_document:
    keep_md: false
  word_document: default

csl: https://www.zotero.org/styles/elsevier-harvard

# this format for the bib files lets you include more than one. 
# The example given on the "grateful" gitHub page does not work for me. e.g.,
# bibliography: 
#   - my-library.bib
#   - grateful-refs.bib
# won't work
# if you are using Zotero then this line allows the references in these files to
# show up when you insert a ciation in the Visual editor. Also, the 
# grateful-refs.bib file is auto generated by the grateful package so you don't
# need to add it yourself.
bibliography: ["example_ms_my-library.bib", "grateful-refs.bib"]

# this is a custom function that is called when you hit the "knit" button.
# it allows you to save your rendered document with a specific name (output_name)
# and location (output_dir). I have also set it up to render all formats at once
# as specified in the "output" part of the YAML header (above this) 

# output_name: -> the root name of the file(s) i.e., no extenstion
# output_path: -> this relative the location of Rmd file. In the case of this 
#                 example we are in the '04-manuscript' folder so 'rendered' is
#                 a subfolder of that.
knit: (
  function(inputFile, encoding) { 

    output_name <- 'example_ms';
    folder_path <- 'rendered';  
                                
                                
  
    rmarkdown::render(
      input       = inputFile, 
      encoding    = encoding, 
      params      = list(sub_title = output_name),      
      output_file = output_name,
      output_dir = folder_path, output_format = "all") })
---

```{r global_options, include=FALSE}
# these set some basic options for the rendering engine. Note that like all things R, you can not count on consistency. That is, what is set here does not apply to all formats.
# fig.pos = sets the positioning of plots - see https://bookdown.org/yihui/rmarkdown-cookbook/figure-placement.html
knitr::opts_chunk$set(fig.pos = 'H')

# this is to try and help with adding captions to figures - see https://stackoverflow.com/questions/35486935/knitr-and-figure-caption-in-html
knitr::opts_knit$set(eval.after = 'fig.cap')
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# none of these are needed to produce an rmarkdown document. They are only here to demonstrate different ways of adding code, plots, package citations, etc. to your document.
library("tidyverse")
library("ggplot2")
library("cowplot")
library("grateful")
library("palmerpenguins")
library("flextable")

# get the packages uses and write the grateful-refs.bib file to the manuscripts folder. This gets ALL of the packages loaded. If you want to limit or be specific you can use scan_packages() to list what is loaded and then create a list of the ones you want to use. For example:

scan_packages() # shows you what is loaded / used

# limits the reference list to just tidyverse and renv
get_pkgs_info(pkgs = c("tidyverse", "renv"), out.dir = "../04-manuscript/")

# this will do everything. This line overwrites the output of the line above so comment out to see what the result is
get_pkgs_info(out.dir = "../04-manuscript/")
```

**Title**: The title of your groundbreaking research paper

First Author^1^\*, Second Author^1^, Third Author^2,1^

1.  Dept. of Biology, Institution A, City, Province, Country

2.  Environmental Science Centre, Governmental Organisation, City, Province, Country

\*Corresponding Author

email: first.author\@institution.ca (FA)

**Author Contributions:** FA conceived of the study, conducted the analyses, and wrote the original, and revised drafts of the manuscript. SA, and TA, helped with the draft manuscript and revisions and supplied guidance to FA. TA provided the data for the case study, contributed to the revisions, and assisted with the analysis of the case study data.

**Data Availability:** The data and code that support the findings of this study are openly available on Zenodo / GitHub at <https://link_to_archived_release_or_GitHub.com>.

If I was publishing this as an HTML document and wanted the link to be pretty versus human readable, I would use [this format](https://link_to_archived_release_or_GitHub.com) instead (click on the hyper link in Visual mode to edit it)

**Conflict of Interest statement**

No conflicts of interest

**Acknowledgements:** We would like to thank a whole bunch of people.

\newpage

# Abstract

1.  Ecologists/biologists and all sorts of other gists often have lots of questions about lots of stuff

2.  We evaluated a bunch of things using sophisticated methods, a ridiculously complicated study design and then carried out complicated statistical tests

3.  We discovered a bunch of things that we didn't already know but suspected

4.  Our research has greatly advanced our knowledge about stuff and will make a significant contribution to something and someone at some point in time

**Key-words**: stuff, something, things

# Introduction

## An example of adding citations in RMarkdown...

Ecologists have long recognized that some combinations of species are regularly found together, while other combinations occur infrequently [@Cole:1949dz; @Elton:1946dl].

The above format wraps the citation in brackets e.g., (Smith & Wesson 1912) but if you want to reference the authors by name instead e.g., Smith & Wesson (1912) of just as a citation you can use this format instead (i.e., no square brackets around the cite key)

@Cole:1949dz and @Elton:1946dl both found that blah blah blah

# Methods

To evaluate the ...

As with Pielou's Evenness [@Pielou:1967ea], Shannon's diversity index [@Shannon:1948iy]$(H)$ is normally calculated from species abundance values; however, for our purposes it is calculated from the column totals (species richness per sample) using the following equation...

$$
H_x = -S[P(i_x) \times ln(P(i_x))]
$$

where $x$ denotes which set of values we are using to calculate the index (observed, minimal or maximal), and $P(i_x)$ is the proportion of species that occur in each sample $(i)$.

The above demonstrates both "inline" and "display" math formats. If you look at the Source version you will see that it is simply the number of \$ symbols before and after that differentiates between the two. An excellent (and simple) guide on inserting math into your R Markdown documents can be found here:\
<https://rpruim.github.io/s341/S19/from-class/MathinRmd.html>

```{r results = 'asis', echo=FALSE}
# this code chunk is for the grateful package. It prints out a text summary of all of the packages you have used in your project. Again you cn either list the ones you want to include or "omit" ones you want to exclude
cite_packages(output = "paragraph", out.dir = "../04-manuscript/", omit = c("knitr", "tinytex"))
```

All code along with the simulation algorithms used are available on Zenodo / GitHub <https://link_to_archived_release_or_GitHub.com>.

# Results

This sections is mostly text with links to your figures. In some cases you can include figures and tables etc. for review. It depends on the journal. Regardless, inserting figures and tables are demontrated below in the Tables section and Figures section. But you can refer to them here. This is another one of those things that is not consistent across output types. That is it works in some cases and not others.

For example we can reference Figure 1 here using the following code: \ref{fig:example_ms_figure_01}

# Discussion

# References

<!-- this little code block is a comment that won't show up in the knitted document. It is a good way to add hidden things and comments to your RMarkdown document. For example... -->

<!-- this little chunk of code (look at it in the "Source" view - the ::: stuff below) forces the references to show up here. If you don't use this then they are put at the end of the document by default -->

::: {#refs}
:::

\newpage

# Tables

**Table 1.** Mean body mass of penguins on different islands over time.

```{r echo=FALSE, message=FALSE, warning=FALSE}
penguin_sum <- penguins %>%
  group_by(island, year) %>%
  summarize(mean_body_mass_g = mean(body_mass_g, na.rm = TRUE)) %>% 
  ungroup()
```

```{r table_01, echo=FALSE, message=FALSE, warning=FALSE, include=TRUE, paged.print=TRUE}
# kable(x = penguin_sum, 
#       col.names = c("Island", "Year", "Mean Body Mass (g)")) %>%
#   kable_styling(latex_options = "hold_position") 

# without the "hold_position" the table ends up at the top of the page
# Also, to get this to work in MS Word we need to delete this whole code chunk.
# I will show you why.
```

\newpage

## Alternate 'flextable' version that works if your output is to MS Word

Note: for the Word version the `kable` does not output correctly. In fact it throws an error ðŸ™„. You could try using the `flextable` package instead: <https://taehoonh.me/content/post/alternative-to-kable-function-when-knitting-to-ms-word.html>

```{r table_01_b, echo=FALSE, message=FALSE, warning=FALSE, include=TRUE, paged.print=TRUE}

penguin_sum %>% 
  regulartable()
```

\newpage

# Figure Captions

**Figure 1**. Pretty coloured dots about penguins

**Figure 2**. Wow, even prettier plot about penguins that shows stuff

**Figure 3**. Another plot about penguins ðŸ¥±

\newpage

# Figures

The basic way to insert a figure is to use this format (see source version). But you don't have a tonne of control over formatting so using a code chunk might be better.

### First the basic URL style insert:

![Figure 1 caption text: - Pretty coloured dots about penguins.](../03-figs/example_ms_figure_01.png)

\newpage

### Inserting a figure by using a code chunk

```{r example_ms_figure_01, echo=FALSE, out.width = "70%", fig.align = "center", fig.cap="Pretty coloured dots about penguins. This caption is in the code chunk header."}
knitr::include_graphics("../03-figs/example_ms_figure_01.png")
```

\newpage

<!-- You CAN include a caption in the code chunk header (fig.cap) but I have to say that getting the numbering and formatting all sorted out is not easy. Sometimes it works (auto-numbering) and sometimes it doesn't. I think it is easier to use text as demonstrated above under Figure Captions but I include it here for completeness. I think the Bookdown package (versus RMarkdown) is more sophisticated when it comes to auto-numbering figures etc. -->

```{r example_ms_figure_02, echo=FALSE, message=FALSE, warning=FALSE, out.width="50%", fig.cap="Wow, even prettier plot about penguins that shows stuff."}
penguins %>%
  select(species, body_mass_g, ends_with("_mm")) %>% 
  GGally::ggpairs(aes(color = species),
          columns = c("flipper_length_mm", "body_mass_g", 
                      "bill_length_mm", "bill_depth_mm")) +
  scale_colour_manual(values = c("darkorange","purple","cyan4")) +
  scale_fill_manual(values = c("darkorange","purple","cyan4"))
```

\newpage

```{r example_ms_figure_03, file="../01-scripts/r_scripts/example_ms_figure_03.R", echo=FALSE, message=FALSE, warning=FALSE}
# this code chunk calls an external script to generate the plot. If you
# want to load or run code not for a plot you could also use the following.
# Note that it does not seem to work for plots.
# source("../01-scripts/r_scripts/example_ms_figure_03.R", local = knitr::knit_global())
```

\newpage

# Appendices

```{=html}
<!-- You might want to look into Bookdown if you want to do anything fancier
with your manuscript. Bookdown allows for automatic Table and Figure numbering
as well as cross referencing. That is you can create links between 'Fig 1' in
your manuscript that links to the actual figure and automatically increment the
the figure numbers as you add or remove them from the document.

I add this here because Appendices can require special handling by some 
journals and Bookdown might allow you to do that automagically -->
```
